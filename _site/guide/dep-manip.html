<!-- _includes/base.html -->





<!-- base is: .. -->
<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="" />

    <link rel="stylesheet" type="text/css" media="screen" href="../stylesheets/stylesheet.css">

    <title></title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="">View on GitHub</a>

          <h1 id="project_title"><a href="..">PME</a> @ <a href="http://commonjava.github.io/">Red Hat</a></h1>
          <h2 id="project_tagline">Standardize Your Builds</h2>
        </header>
    </div>
    <div id="navlink_wrap" class="outer">
        
    </div>
    
    <div id="pagetitle_wrap" class="outer">
      <h3 id="pagetitle" class="inner">Dependency Manipulation</h3>
    </div>
    




    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3 id="overview">Overview</h3>

<p>PME can override a set of dependency versions using a remote pom (BOM) file. By default, all dependencies listed in the remote pom will be added to the current build. This has the effect of overriding matching transitive dependencies, as well as those specified directly in the pom. </p>

<p>Use the <code>dependencyManagement</code> property to list your BOMs:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyManagement=org.foo:my-dep-pom:1.0
</code></pre></div>
<p>Multiple remote dependency-management poms can be specified using a comma separated list of GAVs (groupId, artifactId, version). The poms are specified in order of priority, so if the remote boms contain some of the same dependencies, the versions listed in the first bom in the list will be used.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyManagement=org.foo:my-dep-pom:1.0,org.bar:my-dep-pom:2.0
</code></pre></div>
<p>The extension will change any parent reference it finds that matches an entry in the remote BOM i.e.
<code>
      &lt;parent&gt;
         &lt;groupId&gt;org.switchyard&lt;/groupId&gt;
         &lt;artifactId&gt;switchyard-parent&lt;/artifactId&gt;
         &lt;version&gt;2.0.0.Alpha1&lt;/version&gt;
</code>
will change to
<code>
      &lt;parent&gt;
         &lt;groupId&gt;org.switchyard&lt;/groupId&gt;
         &lt;artifactId&gt;switchyard-parent&lt;/artifactId&gt;
         &lt;version&gt;2.0.0.Alpha1-rebuild-1&lt;/version&gt;
</code></p>

<p><strong>NOTE:</strong> Existing dependencies that reference a property the tool will update this property with the new version. If the property can&#39;t be found (e.g. it was inherited), a new one will be injected at the top level. This update of the property&#39;s value <strong>may</strong> implicitly align other dependencies using the same property that were not explicitly requested to be aligned.</p>

<h3 id="direct-dependencies">Direct Dependencies</h3>

<p>By default the extension will override dependencies using declarations from the remote BOM. However, by setting the property <code>overrideDependencies</code> to <code>false</code>, the behavior can be disabled:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyManagement=org.foo:my-dep-pom:1.0 -DoverrideDependencies=false
</code></pre></div>
<p>Note that this will still alter any external parent references.</p>

<h3 id="direct-transitive-dependencies">Direct/Transitive Dependencies</h3>

<p>By default the extension will inject all dependencies declared in the remote BOM. This will also override dependencies that are not directly specified in the project. If these transitive dependencies should not be overridden, the option <code>overrideTransitive</code> can be set to <code>false</code> to disable this feature.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyManagement=org.foo:my-dep-pom:1.0 -DoverrideTransitive=false
</code></pre></div>
<h3 id="exclusions-and-per-module-overrides">Exclusions and Per Module Overrides</h3>

<p>In a multi-module build it is considered good practice to coordinate dependency version among the modules using dependency management.  In other words, if module A and B both use dependency X, both modules should use the same version of dependency X.  Therefore, the default behaviour of this extension is to use a single set of dependency versions applied to all modules.</p>

<h4 id="per-module-override">Per-Module Override</h4>

<p>However, there are certain cases where it is useful to use different versions of the same dependency in different modules.  For example, if the project includes integration code for multiple versions of a particular API. In that case it is possible to apply a version override to a specific module of a multi-module build using a property starting with <code>dependencyExclusion.</code> and having the following format:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.[groupId]:[artifactId]@[moduleGroupId]:[moduleArtifactId]=[version]
</code></pre></div>
<p>For example to apply an explicit dependency override only to module B of project foo.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.junit:junit@org.foo:moduleB=4.10
</code></pre></div>
<h4 id="per-module-prevention-of-override">Per-Module Prevention of Override</h4>

<p>It is also possible to <strong>prevent overriding dependency versions</strong> on a per module basis:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.[groupId]:[artifactId]@[moduleGroupId]:[moduleArtifactId]=
</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.junit:junit@org.foo:moduleB=
</code></pre></div>
<h4 id="override-prevention-with-wildcards">Override Prevention with Wildcards</h4>

<p>Likewise, you can prevent overriding a dependency version across the entire project using a wildcard:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.[groupId]:[artifactId]@*=
</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.junit:junit@*=
</code></pre></div>
<p>Or, you can prevent overriding a dependency version across the entire project where the groupId matches, using multiple wildcards:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.[groupId]:*@*=
</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DdependencyExclusion.junit:*@*=
</code></pre></div>
<h3 id="strict-mode-version-alignment">Strict Mode Version Alignment</h3>

<p>When aligning dependency versions to some shared standard, it&#39;s possible to introduce incompatibilities that stem from too large of a version change. For instance, while it might be safe to revise a dependency&#39;s version from 1.5 to 1.5.1, it may not be safe to revise it to 2.0, or even 1.6.</p>

<p>In cases where this is a concern, and for dependencies whose versions are aligned via a BOM (not via explicit overrides, as explained above), strict-mode version alignment checks can be enabled using:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DstrictAlignment=true
</code></pre></div>
<p>This will detect cases where the adjusted version doesn&#39;t start with the old version (i.e. 1.0 -&gt; 1.0.1), <strong>not</strong> do the alignment and report the mismatch as a warning in the build&#39;s console output.</p>

<p>If, instead, the build should fail when strict-mode checks are violated, add the <code>strictViolationFails=true</code> property:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DstrictAlignment=true -DstrictViolationFails=true
</code></pre></div>
<p>This will cause the build to fail with a ManipulationException, and prevent the extension from rewriting any POM files.</p>

<p><strong>NOTE:</strong> dependency exclusions they will not work if the dependency uses a version property that has been changed by another dependency modification. Explicit version override will overwrite the property value though.</p>

<h3 id="dependency-property-injection-deprecated">Dependency Property Injection (DEPRECATED)</h3>

<p>The extension will automatically set properties which match the version overrides.  These properties can be used, for example, in resource filtering in the build.  By default the extension supports two different formats for the properties. It is controlled by the property:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">-DversionPropertyFormat=[VG|VGA|NONE]
</code></pre></div>
<p>Where:</p>

<ul>
<li><code>VG</code> is <code>version.&lt;group&gt;</code> (e.g. <code>version.org.slf4j</code>)</li>
<li><code>VGA</code> is <code>version.&lt;group&gt;.&lt;artifact&gt;</code></li>
<li><code>NONE</code> disables the injection</li>
</ul>

<p>The default is <code>NONE</code>.</p>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">This site is maintained by <a href="mailto:jdcasey@redhat.com">Red Hat</a>.</p>
        <p class="copyright">Its layout is based on the Slate theme by <a href="https://github.com/jasoncostello">Jason Costello</a>.</p>
      </footer>
    </div>

  </body>
</html>

