<!-- _includes/base.html -->





<!-- base is: .. -->
<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="" />

    <link rel="stylesheet" type="text/css" media="screen" href="../stylesheets/stylesheet.css">

    <title></title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="">View on GitHub</a>

          <h1 id="project_title"><a href="..">PME</a> @ <a href="http://commonjava.github.io/">Red Hat</a></h1>
          <h2 id="project_tagline">Standardize Your Builds</h2>
        </header>
    </div>
    <div id="navlink_wrap" class="outer">
        
    </div>
    
    <div id="pagetitle_wrap" class="outer">
      <h3 id="pagetitle" class="inner">Plugin Manipulation</h3>
    </div>
    




    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3 id="overview">Overview</h3>

<p>PME can align plugin versions and configuration using a similar pattern to <a href="/guide/dep-manip.html">dependencies</a>. It also has the ability to standardize the use of <code>skip</code> flags that determine whether the <code>maven-install-plugin</code> and <code>maven-deploy-plugin</code> execute. Finally, by default PME will inject plugin executions for the <code>project-sources-maven-plugin</code> and <code>buildmetadata-maven-plugin</code>, in order to promote reproducibility of the project build.</p>

<h3 id="basic-plugin-alignment">Basic Plugin Alignment</h3>

<p>A remote plugin management POM is used to specify the plugin versions (and configuration) to inject:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DpluginManagement=org.jboss:jboss-parent:10
</code></pre></div>
<p>This will inject all <code>&lt;pluginManagement/&gt;</code> versions and configuration from the remote POM into the local POM. As with <a href="/guide/dep-manip.html">dependency management</a>, multiple remote plugin management POMs can be specified on the command line using a comma separated list of GAVs.  The first POM specified will be given the highest priority if conflicts occur.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -DpluginManagement=org.company:pluginMgrA:1.0,org.company:pluginMgrB:2.0
</code></pre></div>
<p>If there is an existing local configuration then it will be merged with the remote. The following configuration controls the precedence:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">-DpluginManagementPrecedence=[LOCAL|REMOTE]
</code></pre></div>
<p>Default is <code>REMOTE</code> which means the remote configuration takes precedence over local.</p>

<h3 id="install-and-deploy-skip-flag-alignment">Install and Deploy Skip Flag Alignment</h3>

<p>By default, this extension will disable the skip flag on the install and deploy plugins. This is useful for build environments that compare the results of install with those from deploy as a validation step. More generally, suppressing installation or deployment tends to be an aesthetic decision that can have subtle functional consequences. It&#39;s usually not really worth the hassle.</p>

<p>This feature does support four modes for alignment, controlled via the <strong>enforce-skip</strong> command-line property:</p>

<ol>
<li><strong>none</strong> - (<em>default</em>) don&#39;t do any alignment</li>
<li><strong>on</strong> - (aliased to <strong>true</strong>) enforce that the skip flag is <strong>enabled</strong>, suppressing install and deploy functions of the build (useful mainly for module-specific overrides. See below)</li>
<li><strong>off</strong> - (aliased to <strong>false</strong>) enforce that the skip flag is <strong>disabled</strong> and that install/deploy functions will execute normally</li>
<li><strong>detect</strong> - detect the flag state of the install plugin in the main pom (not in profiles), and adjust <em>any</em> other install- or deploy-plugin references to the skip flag to be consistent.</li>
</ol>

<p>Additionally, the feature supports per-module overrides, which can be specified as:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">-DenforceSkip.org.group.id:artifact-id=(none|on|true|off|false|detect)
</code></pre></div>
<h3 id="project-sources-build-metadata-plugin-injection">Project Sources / Build Metadata Plugin Injection</h3>

<p>The extension will inject an execution of <a href="https://github.com/commonjava/project-sources-maven-plugin">project-sources-maven-plugin</a> and <a href="https://github.com/release-engineering/buildmetadata-maven-plugin">build-metadata-plugin</a> by default. This will result in an archive being created containing all project sources <strong>after</strong> this extension has made any modifications to the pom.xml&#39;s. The archive will only be created in the execution-root project, and will be attached for installation and deployment using the <code>project-sources</code> classifier. The metadata plugin will create a build.properties file containing information (e.g. the command line) on the invoked project. This will also be included in the archive tar.</p>

<p><strong>Note</strong>: this manipulator will only be active by default if one or more other manipulators have been activated.</p>

<p>To skip injection of the sources and metadata plugins, you can use:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -Dproject.src.skip=true
mvn install -Dproject.meta.skip=true
</code></pre></div>
<p>If unspecified, default versions of the project sources and metadata plugins will be injected (currently, version 0.3 and 1.5.0 respectively). To gain more control over this injection, you can specify the versions for project sources and metadata plugins like this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mvn install -Dproject.src.version=x.y
mvn install -Dproject.meta.version=x.y
</code></pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">This site is maintained by <a href="mailto:jdcasey@redhat.com">Red Hat</a>.</p>
        <p class="copyright">Its layout is based on the Slate theme by <a href="https://github.com/jasoncostello">Jason Costello</a>.</p>
      </footer>
    </div>

  </body>
</html>

